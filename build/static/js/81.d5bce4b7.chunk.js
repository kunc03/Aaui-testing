(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[81],{1366:function(e,t,a){"use strict";a.r(t);var l=a(0),s=a.n(l),n=a(3),i=a(2),r=a(277),m=a.n(r),o=a(455),c=a(303),p=a.n(c),u=(a(464),a(229)),d=(a(118),a(18));class h extends l.Component{constructor(){super(...arguments),this.state={user:null,user_id:this.props.match.params.user_id,company_id:"",branch_id:"",grup_id:"",optionComapny:[],valueCompany:[],level_multicompany:"client",identity:"",name:"",email:"",phone:"",address:"",level:"",password:"",unlimited:!1,validity:new Date,listCompany:[],listBranch:[],listGrup:[],listLevel:[],optionsGroup:[],valueGroup:[],responseMessage:""},this.handleChangeValidity=e=>{this.setState({validity:e}),console.log("XX datepicker",e),console.log("XX state",this.state.validity)},this.onSubmitEditUser=e=>{e.preventDefault();let t=0==this.state.unlimited?"1":"0",a={company_id:this.state.company_id,group:this.state.valueGroup,grup_id:this.state.grup_id,identity:this.state.identity,name:this.state.name,email:this.state.email,phone:this.state.phone,address:this.state.address,level:this.state.level,status:"active",unlimited:t,validity:this.state.validity.toISOString().split("T")[0]};""===a.company_id||""==a.group||""===a.grup_id||""===a.name||""===a.identity||""===a.email||""===a.level?d.b.warning("Please fill required field."):n.l.put("".concat(n.a,"v1/user/").concat(this.state.user_id),a).then(e=>{if(200===e.status)if(e.data.error)this.setState({responseMessage:e.data.result});else{if(""!==this.state.password){let e={password:this.state.password};n.l.put("".concat(n.a,"v1/user/password/").concat(this.state.user_id),e).then(e=>{console.log("pass: ",e.data)})}n.l.delete("".concat(n.a,"v1/user/assign/").concat(this.state.user_id)).then(e=>{if(200===e.status)for(let t=0;t<this.state.valueCompany.length;t++){let e={user_id:this.state.user_id,company_id:this.state.valueCompany[t],level_multicompany:this.state.level_multicompany};n.l.post("".concat(n.a,"v1/user/assign"),e)}}),"superadmin"===i.a.get("user").data.level?this.props.history.push("/company-detail-super/".concat(a.company_id)):this.props.history.push("/user-company/".concat(this.state.company_id))}})},this.onChangeInput=e=>{const t=e.target,a=t.value,l=t.name;"company_id"===l?n.l.get("".concat(n.a,"v1/branch/company/").concat(a)).then(e=>{if(200===e.status){this.setState({listBranch:e.data.result[0],company_id:a,listGrup:e.data.result[1]});let t=[];e.data.result[0].map(e=>{t.push({value:e.branch_id,label:e.branch_name})}),this.setState({valueGroup:[]}),this.setState({optionsGroup:t}),this.showMultipleCompany(a)}}):this.setState({[l]:a})}}toggleSwitch(e){this.setState({unlimited:!this.state.unlimited})}showMultipleCompany(e){n.l.get("".concat(n.a,"v1/company")).then(t=>{this.setState({valueCompany:[]}),this.setState({optionComapny:[]}),t.data.result.map(e=>{this.state.optionComapny.push({value:e.company_id,label:e.company_name})}),this.setState({optionComapny:this.state.optionComapny.filter(t=>t.value!=e)})})}componentDidMount(){let e=[];n.l.get("".concat(n.a,"v1/user/").concat(this.state.user_id)).then(t=>{if(200===t.status){let a=0==t.data.result.unlimited;this.setState({user:t.data.result,company_id:t.data.result.company_id,branch_id:t.data.result.branch_id,grup_id:t.data.result.grup_id,name:t.data.result.name,identity:t.data.result.identity,email:t.data.result.email,phone:t.data.result.phone,address:t.data.result.address,level:t.data.result.level,unlimited:a,validity:new Date(t.data.result.validity),level_multicompany:t.data.result.level_multicompany}),e=t.data.result.group_id?t.data.result.group_id.split(",").map(Number):[],n.l.get("".concat(n.a,"v1/company")).then(e=>{200===e.status&&this.setState({listCompany:e.data.result}),e.data.result.map(e=>{this.state.optionComapny.push({value:e.company_id,label:e.company_name})}),this.setState({optionComapny:this.state.optionComapny.filter(e=>e.value!=this.state.company_id)})}),n.l.get("".concat(n.a,"v1/branch/company/").concat(this.state.user.company_id)).then(e=>{if(200===e.status){this.setState({listBranch:e.data.result[0],listGrup:e.data.result[1]});let t=[];e.data.result[0].map(e=>{t.push({value:e.branch_id,label:e.branch_name})}),this.setState({optionsGroup:t})}}),n.l.get("".concat(n.a,"v1/user/assign/").concat(this.state.user_id)).then(t=>{200===t.status&&(this.setState({valueCompany:t.data.result.multi_company}),this.setState({valueGroup:e}))});const l=[{level:"superadmin"},{level:"admin"},{level:"client"}];this.setState({listLevel:l})}})}render(){let e="";""!==this.state.validity&&(e=new Date(this.state.validity));const t=this.state.listLevel;return s.a.createElement("div",{className:"pcoded-main-container"},s.a.createElement("div",{className:"pcoded-wrapper"},s.a.createElement("div",{className:"pcoded-content"},s.a.createElement("div",{className:"pcoded-inner-content"},s.a.createElement("div",{className:"main-body"},s.a.createElement("div",{className:"page-wrapper"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-xl-12"},s.a.createElement("h3",{className:"f-24 f-w-800"},"Edit User Management"),s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-block"},s.a.createElement("form",{onSubmit:this.onSubmitEditUser},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Company"),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement("select",{required:!0,className:"form-control",name:"company_id",onChange:this.onChangeInput},s.a.createElement("option",{value:""},"-- Select --"),this.state.listCompany.map(e=>s.a.createElement("option",{value:e.company_id,selected:e.company_id===this.state.user.company_id?"selected":""},e.company_name)))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Level"),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement("select",{style:{textTransform:"capitalize"},name:"level",className:"form-control",onChange:this.onChangeInput,required:!0},s.a.createElement("option",{value:""},"-- Select --"),t.map(e=>s.a.createElement("option",{value:e.level,selected:e.level===this.state.user.level?"selected":""},"client"===e.level?"User":e.level)))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Multiple Company"),s.a.createElement(u.MultiSelect,{id:"multicompany",options:this.state.optionComapny,value:this.state.valueCompany,onChange:e=>this.setState({valueCompany:e}),mode:"tags",removableTags:!0,hasSelectAll:!0,selectAllLabel:"Choose all",enableSearch:!0,resetable:!0,valuePlaceholder:"Select Company"})),this.state.valueCompany.length>0?s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Level Multicompany"),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement("select",{style:{textTransform:"capitalize"},name:"level_multicompany",className:"form-control",onChange:e=>this.setState({level_multicompany:e.target.value}),required:!0},s.a.createElement("option",{value:""},"-- Select --"),t.map(e=>s.a.createElement("option",{value:e.level,selected:e.level===this.state.level_multicompany?"selected":""},"client"===e.level?"User":e.level)))):null,s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Group"),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement(u.MultiSelect,{id:"group",options:this.state.optionsGroup,value:this.state.valueGroup,onChange:e=>this.setState({valueGroup:e}),mode:"tags",enableSearch:!0,resetable:!0,valuePlaceholder:"Select Group"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Role"),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement("select",{required:!0,className:"form-control",name:"grup_id",onChange:this.onChangeInput},s.a.createElement("option",{value:""},"-- Select --"),this.state.listGrup.map(e=>s.a.createElement("option",{value:e.grup_id,selected:e.grup_id===this.state.user.grup_id?"selected":""},e.grup_name)))),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"}," Name "),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement("input",{required:!0,type:"text",name:"name",className:"form-control",placeholder:"Name",value:this.state.name,onChange:this.onChangeInput})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"}," Registration Number "),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement("input",{type:"text",required:!0,name:"identity",className:"form-control",placeholder:"210-1971-74",value:this.state.identity,onChange:this.onChangeInput})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Email"),s.a.createElement(o.a.Text,{className:"text-danger"},"Required"),s.a.createElement("input",{type:"email",required:!0,name:"email",value:this.state.email,className:"form-control",placeholder:"rakaal@gmail.com",onChange:this.onChangeInput})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Phone"),s.a.createElement("input",{type:"text",name:"phone",value:this.state.phone,className:"form-control",placeholder:"081-247-9592",onChange:this.onChangeInput})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input"},"Address"),s.a.createElement("textarea",{value:this.state.address,name:"address",className:"form-control",placeholder:"Address",onChange:this.onChangeInput})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input",htmlFor:!0},"Time Limit"),s.a.createElement("div",{style:{width:"100%"}},s.a.createElement(m.a,{checked:!1,onChange:this.toggleSwitch.bind(this),checked:this.state.unlimited}))),this.state.unlimited&&s.a.createElement("div",{className:"form-group"},s.a.createElement("label",{className:"label-input",htmlFor:!0},"Valid Until"),s.a.createElement("div",{style:{width:"100%"}},s.a.createElement(p.a,{selected:e,onChange:this.handleChangeValidity,dateFormat:"yyyy-MM-dd"}))),s.a.createElement("div",{style:{marginTop:"50px"}},this.state.responseMessage&&s.a.createElement("div",{class:"alert alert-primary",role:"alert"},s.a.createElement("b",null,"ALERT")," Please check you data before submit. ",this.state.responseMessage)),s.a.createElement("button",{type:"submit",className:"btn btn-primary btn-block m-t-100 f-20 f-w-600"},"Save"))))))))))))}}t.default=h}}]);
//# sourceMappingURL=81.d5bce4b7.chunk.js.map