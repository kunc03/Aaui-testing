{"version":3,"sources":["components/news/view.js"],"names":["ViewNews","props","closeModalDelete","e","setState","modalDelete","deleteId","handleContent","content","edited","handleChange","target","name","value","files","length","size","image","imagePreview","URL","createObjectURL","toast","warning","state","id","match","params","companyId","isSaving","userId","title","disabledForm","author","created_at","goBack","bind","this","history","API","get","API_SERVER","then","res","data","error","result","moment","tz","guess","format","USER_ME","Storage","email","status","localStorage","getItem","company_id","user_id","getUserData","getData","session","media","className","src","alt","width","onClick","style","color","level","to","padding","marginRight","fontSize","maxHeight","dangerouslySetInnerHTML","__html","Component"],"mappings":"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","file":"static/js/47.4b41a991.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport API, { API_SERVER, USER_ME } from '../../repository/api';\r\nimport Storage from '../../repository/storage';\r\nimport moment from 'moment-timezone';\r\nimport { Link } from \"react-router-dom\";\r\n\r\nclass ViewNews extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n        edited: false,\r\n        id: this.props.match.params.id ? this.props.match.params.id : '',\r\n        companyId:'',\r\n        image:'',\r\n        imagePreview:'assets/images/no-image.png',\r\n        isSaving: false,\r\n        userId: '',\r\n        content:'Loading...',\r\n        title: '',\r\n        modalDelete: false,\r\n        disabledForm: this.props.disabledForm && this.props.id,\r\n        author:'',\r\n        created_at: ''\r\n    };\r\n    this.goBack = this.goBack.bind(this);\r\n  }\r\n  \r\n  goBack() {\r\n    this.props.history.goBack();\r\n  }\r\n\r\n  closeModalDelete = e => {\r\n    this.setState({ modalDelete: false, deleteId: '' })\r\n  }\r\n\r\n\r\nhandleContent = (e) => {\r\n    this.setState({ content: e, edited:true });\r\n}\r\n  handleChange = e => {\r\n    this.setState({edited: true})\r\n      let {name, value} = e.target;\r\n      if (name==='image'){\r\n        if (e.target.files.length){\r\n            if (e.target.files[0].size <= 5000000) {\r\n                let image = {\r\n                    image: e.target.files[0],\r\n                    imagePreview: URL.createObjectURL(e.target.files[0])\r\n                }\r\n                this.setState(image)\r\n            } else {\r\n              e.target.value = null;\r\n              toast.warning('Image size cannot larger than 5MB and must be an image file')\r\n            }\r\n        }\r\n      }\r\n      else{\r\n          this.setState({[name]: value})\r\n      }\r\n  }\r\n  getData(id){\r\n    API.get(`${API_SERVER}v2/news/read/${id}`).then(res => {\r\n        if (res.data.error){\r\n            toast.error('Error read news')\r\n        }\r\n        else{\r\n            this.setState({\r\n                id: res.data.result.id,\r\n                content: res.data.result.content,\r\n                title: res.data.result.title,\r\n                imagePreview: res.data.result.image ? res.data.result.image : this.state.imagePreview,\r\n                author: res.data.result.author,\r\n                created_at: moment.tz(res.data.result.created_at, moment.tz.guess(true)).format(\"MMMM Do YYYY, h:mm:ss a\")\r\n            })\r\n        }\r\n    })\r\n  }\r\n  getUserData(){\r\n    API.get(`${USER_ME}${Storage.get('user').data.email}`).then(res => {\r\n        if (res.status === 200) {\r\n          this.setState({ companyId: localStorage.getItem('companyID') ? localStorage.getItem('companyID') : res.data.result.company_id, userId: res.data.result.user_id });\r\n        }\r\n    })\r\n  }\r\n  componentDidMount(){\r\n    this.getUserData();\r\n    if (this.props.disabledForm && this.props.id){\r\n        this.getData(this.props.id);\r\n    }\r\n    else if (this.props.match.params.id){\r\n        this.getData(this.props.match.params.id);\r\n    }\r\n    else{\r\n        this.setState({\r\n            content : ''\r\n        })\r\n    }\r\n  }\r\n\r\n  clearSessionForm(){\r\n    this.setState({\r\n        edited: false,\r\n        content : ''\r\n      })\r\n  }\r\n\r\n  render() {\r\n    let {session, media} = this.state;\r\n    return(\r\n        <div className=\"pcoded-main-container\">\r\n            <div className=\"pcoded-wrapper\">\r\n                <div className=\"pcoded-content\">\r\n                    <div className=\"pcoded-inner-content\">\r\n                        <div className=\"main-body\">\r\n                            <div className=\"page-wrapper\">\r\n                                <div className=\"floating-back\">\r\n                                    <img\r\n                                    src={`newasset/back-button.svg`}\r\n                                    alt=\"\"\r\n                                    width={90}\r\n                                    onClick={this.goBack}\r\n                                    ></img>\r\n                                </div>\r\n                                <div className=\"row\">\r\n                                    <div className=\"col-xl-12\">\r\n                                        <div>\r\n                                            <div className=\"card p-20\">\r\n                                                <div className=\"row\">\r\n                                                    <div className=\"col-sm-10 m-b-10\">\r\n                                                        <strong className=\"f-w-bold f-18\" style={{color:'#000'}}>{this.state.title}</strong>\r\n                                                    </div>\r\n                                                    <div className=\"col-sm-2 m-b-20\">\r\n                                                        {\r\n                                                        Storage.get('user').data.level !== 'client' &&\r\n                                                        <Link\r\n                                                        to={`/news/edit/${this.state.id}`}>\r\n                                                            <button\r\n                                                            className=\"btn btn-icademy-primary float-right\"\r\n                                                            style={{ padding: \"7px 8px !important\", marginRight: 30 }}>\r\n                                                                <i className=\"fa fa-edit\"></i>\r\n                                                                Edit\r\n                                                            </button>\r\n                                                        </Link>\r\n                                                        }\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"row\">\r\n                                                    <div className=\"form-field-top-label\" style={{fontSize:12}}>\r\n                                                        Posted on {this.state.created_at}\r\n                                                    </div>\r\n                                                </div>\r\n                                                <div className=\"form-section no-border\">\r\n                                                    <div className=\"row\">\r\n                                                        <div className=\"form-field-top-label\">\r\n                                                            <img src={this.state.imagePreview} style={{maxHeight:300}} />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"row\">\r\n                                                        <div className=\"html-content\">\r\n                                                            <div dangerouslySetInnerHTML={{__html: this.state.content}}></div>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ViewNews;\r\n"],"sourceRoot":""}