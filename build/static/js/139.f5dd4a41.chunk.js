(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[139],{1337:function(e,t,a){"use strict";a.r(t);var s=a(0),i=a.n(s),n=a(252),l=a.n(n),o=(a(301),a(3)),c=a(18),r=a(1613),m=a(2),d=a(19),h=a.n(d);class p extends s.Component{constructor(e){super(e),this.closeModalAllocation=e=>{this.setState({modalAllocation:!1,amount:"",licensesId:"",mode:""})},this.handleChange=e=>{let{name:t,value:a}=e.target;"amount"===t?a<0?this.setState({[t]:0}):this.setState({[t]:a}):this.setState({[t]:a})},this.filter=e=>{e.preventDefault(),this.setState({filter:e.target.value})},this.filterHistory=e=>{e.preventDefault(),this.setState({filterHistory:e.target.value})},this.state={userId:"",companyId:"",data:[],dataLicenses:[],filter:"",filterHistory:"",licensesId:"",licensesTypeId:"",modalAllocation:!1,amount:"",mode:"",id:"",note:"",isSaving:!1}}save(){if(this.setState({isSaving:!0}),""===this.state.amount||"0"===this.state.amount)c.b.warning("Please fill amount"),this.setState({isSaving:!1});else{let e={company_id:this.state.id,licenses_type_id:this.state.licensesTypeId,licenses_allocation_id:this.state.licensesId,amount:this.state.amount,type:this.state.mode,note:this.state.note,created_by:this.state.userId};o.l.post("".concat(o.a,"v2/training/quota/company/transaction"),e).then(e=>{e.data.error?(c.b.error(e.data.result),this.setState({isSaving:!1})):(c.b.success("Success for licenses allocation ".concat(this.state.mode)),this.closeModalAllocation(),this.getAllocation(),this.getHistory(),this.setState({isSaving:!1}))})}}getUserData(){o.l.get("".concat(o.j).concat(m.a.get("user").data.email)).then(e=>{200===e.status&&(this.setState({companyId:localStorage.getItem("companyID")?localStorage.getItem("companyID"):e.data.result.company_id,userId:e.data.result.user_id}),this.getAllocation(),this.getHistory())})}getAllocation(){o.l.get("".concat(o.a,"v2/training/quota/company/").concat(this.state.id)).then(e=>{e.data.error?c.b.error("Error read licenses allocation"):this.setState({dataLicenses:e.data.result})})}getHistory(){o.l.get("".concat(o.a,"v2/training/quota/company/history/").concat(this.state.id)).then(e=>{e.data.error?c.b.error("Error read licenses allocation"):this.setState({data:e.data.result})})}componentDidMount(){this.props.id?this.setState({id:this.props.id}):this.props.match.params.id&&this.setState({id:this.props.match.params.id}),this.getUserData()}render(){String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};const e=[{cell:e=>h.a.tz(e.created_at,h.a.tz.guess(!0)).format("DD-MM-YYYY HH:mm"),name:"Time",selector:"created_at",sortable:!0},{name:"Amount",selector:"amount",sortable:!0},{cell:e=>e.transaction_type.capitalize(),name:"Transaction Type",selector:"transaction_type",sortable:!0},{name:"Licenses Type",selector:"type",sortable:!0},{name:"Note",selector:"note",sortable:!0},{name:"Created By",selector:"created_by",sortable:!0}],t=[{name:"Type",selector:"type",sortable:!0,grow:2},{name:"Notes",selector:"notes",sortable:!0,grow:2},{name:"Remaining Allocation",selector:"remaining_allocation",sortable:!0},{name:"Action",cell:e=>i.a.createElement("div",null,!this.props.lockEdit&&i.a.createElement("button",{onClick:()=>this.setState({modalAllocation:!0,licensesId:e.id,licensesTypeId:e.licenses_type_id,mode:"addition"}),className:"button-table-plus"},"+"),!this.props.lockEdit&&i.a.createElement("button",{onClick:()=>this.setState({modalAllocation:!0,licensesId:e.id,licensesTypeId:e.licenses_type_id,mode:"reduction"}),className:"button-table-min"},"-"))}];let{data:a,dataLicenses:s,filter:n,filterHistory:o}=this.state;return""!=n&&(s=s.filter(e=>JSON.stringify(Object.values(e)).match(new RegExp(n,"gmi")))),""!=o&&(a=a.filter(e=>JSON.stringify(Object.values(e)).match(new RegExp(o,"gmi")))),i.a.createElement("div",{className:"pcoded-main-container",style:this.props.id?{marginLeft:0}:null},i.a.createElement("div",{className:"pcoded-wrapper"},i.a.createElement("div",{className:"pcoded-content",style:this.props.id?{padding:0}:null},i.a.createElement("div",{className:"pcoded-inner-content"},i.a.createElement("div",{className:"main-body"},i.a.createElement("div",{className:"page-wrapper"},!this.props.id&&i.a.createElement("div",{className:"floating-back"},i.a.createElement("img",{src:"newasset/back-button.svg",alt:"",width:90,onClick:this.props.history.goBack.bind(this)})),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-xl-12"},i.a.createElement("div",null,i.a.createElement("div",{className:"card p-20 main-tab-container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-sm-12 m-b-20"},i.a.createElement("strong",{className:"f-w-bold f-18",style:{color:"#000"}},"Licenses"),i.a.createElement("input",{type:"text",placeholder:"Search",onChange:this.filter,className:"form-control float-right col-sm-3"}),i.a.createElement(l.a,{columns:t,data:s,highlightOnHover:!0,defaultSortField:"type",pagination:!0,fixedHeader:!0})))),i.a.createElement("div",{className:"card p-20 main-tab-container"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-sm-12 m-b-20"},i.a.createElement("strong",{className:"f-w-bold f-18",style:{color:"#000"}},"License Allocation History"),i.a.createElement("input",{type:"text",placeholder:"Search",onChange:this.filterHistory,className:"form-control float-right col-sm-3"}),i.a.createElement(l.a,{columns:this.props.lockEdit?[{name:"Time",selector:"created_at",sortable:!0},{name:"Amount",selector:"amount",sortable:!0},{cell:e=>e.transaction_type.capitalize(),name:"Transaction Type",selector:"transaction_type",sortable:!0},{name:"Licenses Type",selector:"type",sortable:!0},{name:"Training Company",selector:"training_company",sortable:!0},{name:"Note",selector:"note",sortable:!0},{name:"Created By",selector:"created_by",sortable:!0}]:e,data:a,highlightOnHover:!0,pagination:!0,fixedHeader:!0})))),i.a.createElement(r.a,{show:this.state.modalAllocation,onHide:this.closeModalAllocation,centered:!0},i.a.createElement(r.a.Header,{closeButton:!0},i.a.createElement(r.a.Title,{className:"text-c-purple3 f-w-bold",style:{color:"#00478C"}},"addition"===this.state.mode?"Add":"Reduce"," Licenses Allocation")),i.a.createElement(r.a.Body,null,i.a.createElement("div",{className:"form-field-top-label"},i.a.createElement("label",{for:"amount"},"Amount of ","addition"===this.state.mode?"Addition":"Reduction",i.a.createElement("required",null,"*")),i.a.createElement("input",{type:"number",name:"amount",size:"50",id:"amount",min:"0",placeholder:"0",value:this.state.amount,onChange:this.handleChange})),i.a.createElement("div",{className:"form-field-top-label",style:{width:"100%"}},i.a.createElement("label",{for:"note"},"Note"),i.a.createElement("textarea",{name:"note",onChange:this.handleChange,value:this.state.note,style:{width:"80%"}}))),i.a.createElement(r.a.Footer,null,i.a.createElement("button",{className:"btn btm-icademy-primary btn-icademy-grey",onClick:this.closeModalAllocation.bind(this)},"Cancel"),i.a.createElement("button",{className:"btn btn-icademy-primary",onClick:this.save.bind(this),disabled:this.state.isSaving},i.a.createElement("i",{className:"fa fa-".concat("addition"===this.state.mode?"plus":"minus")})," ","addition"===this.state.mode?"Add":"Reduce"))))))))))))}}t.default=p}}]);
//# sourceMappingURL=139.f5dd4a41.chunk.js.map