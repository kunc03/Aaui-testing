(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[139],{1338:function(e,t,a){"use strict";a.r(t);var n=a(21),s=a(6),o=a(11),i=a(13),l=a(12),c=a(14),r=a(0),m=a.n(r),d=a(275),u=a.n(d),p=(a(327),a(3)),h=a(24),y=a(1616),f=a(2),b=a(25),g=a.n(b),v=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(i.a)(this,Object(l.a)(t).call(this,e))).closeModalAllocation=function(e){a.setState({modalAllocation:!1,amount:"",licensesId:"",mode:""})},a.handleChange=function(e){var t=e.target,s=t.name,o=t.value;"amount"===s&&o<0?a.setState(Object(n.a)({},s,0)):a.setState(Object(n.a)({},s,o))},a.filter=function(e){e.preventDefault(),a.setState({filter:e.target.value})},a.filterHistory=function(e){e.preventDefault(),a.setState({filterHistory:e.target.value})},a.state={userId:"",companyId:"",data:[],dataLicenses:[],filter:"",filterHistory:"",licensesId:"",licensesTypeId:"",modalAllocation:!1,amount:"",mode:"",id:"",note:"",isSaving:!1},a}return Object(c.a)(t,e),Object(o.a)(t,[{key:"save",value:function(){var e=this;if(this.setState({isSaving:!0}),""===this.state.amount||"0"===this.state.amount)h.b.warning("Please fill amount"),this.setState({isSaving:!1});else{var t={company_id:this.state.id,licenses_type_id:this.state.licensesTypeId,licenses_allocation_id:this.state.licensesId,amount:this.state.amount,type:this.state.mode,note:this.state.note,created_by:this.state.userId};p.l.post("".concat(p.a,"v2/training/quota/company/transaction"),t).then((function(t){t.data.error?(h.b.error(t.data.result),e.setState({isSaving:!1})):(h.b.success("Success for licenses allocation ".concat(e.state.mode)),e.closeModalAllocation(),e.getAllocation(),e.getHistory(),e.setState({isSaving:!1}))}))}}},{key:"getUserData",value:function(){var e=this;p.l.get("".concat(p.j).concat(f.a.get("user").data.email)).then((function(t){200===t.status&&(e.setState({companyId:localStorage.getItem("companyID")?localStorage.getItem("companyID"):t.data.result.company_id,userId:t.data.result.user_id}),e.getAllocation(),e.getHistory())}))}},{key:"getAllocation",value:function(){var e=this;p.l.get("".concat(p.a,"v2/training/quota/company/").concat(this.state.id)).then((function(t){t.data.error?h.b.error("Error read licenses allocation"):e.setState({dataLicenses:t.data.result})}))}},{key:"getHistory",value:function(){var e=this;p.l.get("".concat(p.a,"v2/training/quota/company/history/").concat(this.state.id)).then((function(t){t.data.error?h.b.error("Error read licenses allocation"):e.setState({data:t.data.result})}))}},{key:"componentDidMount",value:function(){this.props.id?this.setState({id:this.props.id}):this.props.match.params.id&&this.setState({id:this.props.match.params.id}),this.getUserData()}},{key:"render",value:function(){var e=this;String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var t=[{cell:function(e){return g.a.tz(e.created_at,g.a.tz.guess(!0)).format("DD-MM-YYYY HH:mm")},name:"Time",selector:"created_at",sortable:!0},{name:"Amount",selector:"amount",sortable:!0},{cell:function(e){return e.transaction_type.capitalize()},name:"Transaction Type",selector:"transaction_type",sortable:!0},{name:"Licenses Type",selector:"type",sortable:!0},{name:"Note",selector:"note",sortable:!0},{name:"Created By",selector:"created_by",sortable:!0}],a=[{name:"Type",selector:"type",sortable:!0,grow:2},{name:"Notes",selector:"notes",sortable:!0,grow:2},{name:"Remaining Allocation",selector:"remaining_allocation",sortable:!0},{name:"Action",cell:function(t){return m.a.createElement("div",null,!e.props.lockEdit&&m.a.createElement("button",{onClick:function(){return e.setState({modalAllocation:!0,licensesId:t.id,licensesTypeId:t.licenses_type_id,mode:"addition"})},className:"button-table-plus"},"+"),!e.props.lockEdit&&m.a.createElement("button",{onClick:function(){return e.setState({modalAllocation:!0,licensesId:t.id,licensesTypeId:t.licenses_type_id,mode:"reduction"})},className:"button-table-min"},"-"))}}],n=this.state,s=n.data,o=n.dataLicenses,i=n.filter,l=n.filterHistory;return""!=i&&(o=o.filter((function(e){return JSON.stringify(Object.values(e)).match(new RegExp(i,"gmi"))}))),""!=l&&(s=s.filter((function(e){return JSON.stringify(Object.values(e)).match(new RegExp(l,"gmi"))}))),m.a.createElement("div",{className:"pcoded-main-container",style:this.props.id?{marginLeft:0}:null},m.a.createElement("div",{className:"pcoded-wrapper"},m.a.createElement("div",{className:"pcoded-content",style:this.props.id?{padding:0}:null},m.a.createElement("div",{className:"pcoded-inner-content"},m.a.createElement("div",{className:"main-body"},m.a.createElement("div",{className:"page-wrapper"},!this.props.id&&m.a.createElement("div",{className:"floating-back"},m.a.createElement("img",{src:"newasset/back-button.svg",alt:"",width:90,onClick:this.props.history.goBack.bind(this)})),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-xl-12"},m.a.createElement("div",null,m.a.createElement("div",{className:"card p-20 main-tab-container"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold f-18",style:{color:"#000"}},"Licenses"),m.a.createElement("input",{type:"text",placeholder:"Search",onChange:this.filter,className:"form-control float-right col-sm-3"}),m.a.createElement(u.a,{columns:a,data:o,highlightOnHover:!0,defaultSortField:"type",pagination:!0,fixedHeader:!0})))),m.a.createElement("div",{className:"card p-20 main-tab-container"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold f-18",style:{color:"#000"}},"License Allocation History"),m.a.createElement("input",{type:"text",placeholder:"Search",onChange:this.filterHistory,className:"form-control float-right col-sm-3"}),m.a.createElement(u.a,{columns:this.props.lockEdit?[{name:"Time",selector:"created_at",sortable:!0},{name:"Amount",selector:"amount",sortable:!0},{cell:function(e){return e.transaction_type.capitalize()},name:"Transaction Type",selector:"transaction_type",sortable:!0},{name:"Licenses Type",selector:"type",sortable:!0},{name:"Training Company",selector:"training_company",sortable:!0},{name:"Note",selector:"note",sortable:!0},{name:"Created By",selector:"created_by",sortable:!0}]:t,data:s,highlightOnHover:!0,pagination:!0,fixedHeader:!0})))),m.a.createElement(y.a,{show:this.state.modalAllocation,onHide:this.closeModalAllocation,centered:!0},m.a.createElement(y.a.Header,{closeButton:!0},m.a.createElement(y.a.Title,{className:"text-c-purple3 f-w-bold",style:{color:"#00478C"}},"addition"===this.state.mode?"Add":"Reduce"," Licenses Allocation")),m.a.createElement(y.a.Body,null,m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"amount"},"Amount of ","addition"===this.state.mode?"Addition":"Reduction",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"number",name:"amount",size:"50",id:"amount",min:"0",placeholder:"0",value:this.state.amount,onChange:this.handleChange})),m.a.createElement("div",{className:"form-field-top-label",style:{width:"100%"}},m.a.createElement("label",{for:"note"},"Note"),m.a.createElement("textarea",{name:"note",onChange:this.handleChange,value:this.state.note,style:{width:"80%"}}))),m.a.createElement(y.a.Footer,null,m.a.createElement("button",{className:"btn btm-icademy-primary btn-icademy-grey",onClick:this.closeModalAllocation.bind(this)},"Cancel"),m.a.createElement("button",{className:"btn btn-icademy-primary",onClick:this.save.bind(this),disabled:this.state.isSaving},m.a.createElement("i",{className:"fa fa-".concat("addition"===this.state.mode?"plus":"minus")})," ","addition"===this.state.mode?"Add":"Reduce"))))))))))))}}]),t}(r.Component);t.default=v}}]);
//# sourceMappingURL=139.f15cd28d.chunk.js.map