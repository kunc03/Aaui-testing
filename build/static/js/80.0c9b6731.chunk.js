(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[80],{1366:function(e,t,n){"use strict";n.r(t);var i=n(21),a=n(6),o=n(11),r=n(13),s=n(12),c=n(31),l=n(14),u=n(0),d=n.n(u),p=n(24),f=n(3),m=n(2),h=n(324),g=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(r.a)(this,Object(s.a)(t).call(this,e))).closeModalDelete=function(e){n.setState({modalDelete:!1,deleteId:""})},n.save=function(e){if(n.setState({isSaving:!0}),e.preventDefault(),n.state.title.length&&n.state.content.length)if(n.state.id){var t={title:n.state.title,content:n.state.content};f.l.put("".concat(f.a,"v2/news/").concat(n.state.id),t).then((function(e){if(e.data.error)p.b.error("Error edit news"),n.setState({isSaving:!1});else if(n.state.image){var t=new FormData;t.append("image",n.state.image),f.l.put("".concat(f.a,"v2/news/image/").concat(n.state.id),t).then((function(e){e.data.error?(p.b.warning("News edited but fail to upload image"),n.setState({edited:!1,isSaving:!1})):(p.b.success("News edited"),n.setState({edited:!1,isSaving:!1}),n.props.history.push("/news"))}))}else p.b.success("News edited"),n.setState({edited:!1,isSaving:!1}),n.props.history.push("/news")}))}else{var i={company_id:n.state.companyId,title:n.state.title,content:n.state.content,created_by:n.state.userId};f.l.post("".concat(f.a,"v2/news"),i).then((function(e){if(e.data.error)p.b.error("Error saving news"),n.setState({isSaving:!1});else if(n.state.image){var t=new FormData;t.append("image",n.state.image),f.l.put("".concat(f.a,"v2/news/image/").concat(e.data.result.insertId),t).then((function(e){e.data.error?(p.b.warning("News saved but fail to upload image"),n.setState({edited:!1,isSaving:!1})):(p.b.success("News saved"),n.setState({edited:!1,isSaving:!1}),n.props.history.push("/news"))}))}else p.b.success("News saved"),n.setState({edited:!1,isSaving:!1}),n.props.history.push("/news")}))}else p.b.warning("Some field is required, please check your data."),n.setState({isSaving:!1})},n.handleContent=function(e){n.setState({content:e,edited:!0})},n.handleChange=function(e){n.setState({edited:!0});var t=e.target,a=t.name,o=t.value;if("image"===a){if(e.target.files.length)if(e.target.files[0].size<=5e6){var r={image:e.target.files[0],imagePreview:URL.createObjectURL(e.target.files[0])};n.setState(r)}else e.target.value=null,p.b.warning("Image size cannot larger than 5MB and must be an image file")}else n.setState(Object(i.a)({},a,o))},n.state={edited:!1,id:n.props.match.params.id?n.props.match.params.id:"",companyId:"",image:"",imagePreview:"assets/images/no-image.png",isSaving:!1,userId:"",content:"Loading...",title:"",modalDelete:!1,disabledForm:n.props.disabledForm&&n.props.id},n.goBack=n.goBack.bind(Object(c.a)(n)),n}return Object(l.a)(t,e),Object(o.a)(t,[{key:"goBack",value:function(){this.props.goBack?this.props.goBack():this.props.history.push("/news")}},{key:"getData",value:function(e){var t=this;f.l.get("".concat(f.a,"v2/news/read/").concat(e)).then((function(e){e.data.error?p.b.error("Error read news"):t.setState({id:e.data.result.id,content:e.data.result.content,title:e.data.result.title,imagePreview:e.data.result.image?e.data.result.image:t.state.imagePreview})}))}},{key:"getUserData",value:function(){var e=this;f.l.get("".concat(f.j).concat(m.a.get("user").data.email)).then((function(t){200===t.status&&e.setState({companyId:localStorage.getItem("companyID")?localStorage.getItem("companyID"):t.data.result.company_id,userId:t.data.result.user_id})}))}},{key:"componentDidMount",value:function(){this.getUserData(),this.props.disabledForm&&this.props.id?this.getData(this.props.id):this.props.match.params.id?this.getData(this.props.match.params.id):this.setState({content:""})}},{key:"clearSessionForm",value:function(){this.setState({edited:!1,content:""})}},{key:"render",value:function(){var e=this,t=this.state;t.session,t.media;return d.a.createElement("div",{className:"pcoded-main-container"},d.a.createElement("div",{className:"pcoded-wrapper"},d.a.createElement("div",{className:"pcoded-content"},d.a.createElement("div",{className:"pcoded-inner-content"},d.a.createElement("div",{className:"main-body"},d.a.createElement("div",{className:"page-wrapper"},d.a.createElement("div",{className:"floating-back"},d.a.createElement("img",{src:"newasset/back-button.svg",alt:"",width:90,onClick:this.goBack})),d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-xl-12"},d.a.createElement("div",null,d.a.createElement("div",{className:"card p-20"},d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-sm-10 m-b-20"},d.a.createElement("strong",{className:"f-w-bold f-18",style:{color:"#000"}},this.props.id?"Detail":this.props.match.params.id?"Edit":"Create"," News")),d.a.createElement("div",{className:"col-sm-2 m-b-20"},this.props.disabledForm&&d.a.createElement("button",{onClick:this.props.goEdit,className:"btn btn-icademy-primary float-right",style:{padding:"7px 8px !important",marginRight:30}},d.a.createElement("i",{className:"fa fa-edit"}),"Edit"))),d.a.createElement("div",{className:"form-section no-border"},d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-sm-12 m-b-20"},d.a.createElement("strong",{className:"f-w-bold",style:{color:"#000",fontSize:"15px"}},"News / Announcements"))),d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"form-field-top-label"},d.a.createElement("label",{for:"image"},"Thumbnail"),d.a.createElement("label",{for:"image",style:{cursor:"pointer",borderRadius:"10px",overflow:"hidden"}},d.a.createElement("img",{src:this.state.imagePreview,height:"54.8px"})),d.a.createElement("input",{type:"file",accept:"image/*",name:"image",id:"image",onChange:this.handleChange,disabled:this.state.disabledForm})),d.a.createElement("div",{className:"form-field-top-label"},d.a.createElement("label",{for:"title"},"Title",d.a.createElement("required",null,"*")),d.a.createElement("input",{type:"text",name:"title",size:"50",id:"name",placeholder:"XXXXX XXXXX XXXXX",value:this.state.title,onChange:this.handleChange,disabled:this.state.disabledForm})),d.a.createElement("div",{className:"form-field-top-label",style:{width:"80%"}},d.a.createElement("label",{for:"content"},"Content",d.a.createElement("required",null,"*")),d.a.createElement("input",{id:"myFile",type:"file",name:"myFile",style:{display:"none"},onChange:""}),"Loading..."!==this.state.content?d.a.createElement(h.a,{name:"content",apiKey:"j18ccoizrbdzpcunfqk7dugx72d7u9kfwls7xlpxg7m21mb5",initialValue:this.state.content,value:this.state.content,init:{height:400,convert_urls:!1,image_class_list:[{title:"None",value:""},{title:"Responsive",value:"img-responsive"},{title:"Thumbnail",value:"img-responsive img-thumbnail"}],file_browser_callback_types:"image",file_picker_callback:function(e,t,n){if("image"==n.filetype){var i=document.getElementById("myFile");i.click(),i.onchange=function(){var t=this,n=new FormData;n.append("file",this.files[0]),window.$.ajax({url:"".concat(f.a,"v2/media/upload"),type:"POST",data:n,processData:!1,contentType:!1,success:function(n){e(n.result.url),t.value=""}})}}},plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","autoresize"],toolbar:"undo redo | bold italic backcolor |                                                                             alignleft aligncenter alignright alignjustify | image |                                                                                 bullist numlist outdent indent | removeformat | help"},onEditorChange:function(t){return e.handleContent(t)}}):null))),d.a.createElement("div",{className:"row",style:{justifyContent:"flex-end"}},!this.props.disabledForm&&d.a.createElement("button",{disabled:this.state.isSaving,onClick:this.save,className:"btn btn-icademy-primary float-right",style:{padding:"7px 8px !important",marginRight:30}},d.a.createElement("i",{className:"fa fa-save"}),this.state.isSaving?"Saving...":"Save"))))))))))))}}]),t}(u.Component);t.default=g},324:function(e,t,n){"use strict";var i=n(0),a=n(10),o=function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},r={onActivate:a.func,onAddUndo:a.func,onBeforeAddUndo:a.func,onBeforeExecCommand:a.func,onBeforeGetContent:a.func,onBeforeRenderUI:a.func,onBeforeSetContent:a.func,onBeforePaste:a.func,onBlur:a.func,onChange:a.func,onClearUndos:a.func,onClick:a.func,onContextMenu:a.func,onCopy:a.func,onCut:a.func,onDblclick:a.func,onDeactivate:a.func,onDirty:a.func,onDrag:a.func,onDragDrop:a.func,onDragEnd:a.func,onDragGesture:a.func,onDragOver:a.func,onDrop:a.func,onExecCommand:a.func,onFocus:a.func,onFocusIn:a.func,onFocusOut:a.func,onGetContent:a.func,onHide:a.func,onInit:a.func,onKeyDown:a.func,onKeyPress:a.func,onKeyUp:a.func,onLoadContent:a.func,onMouseDown:a.func,onMouseEnter:a.func,onMouseLeave:a.func,onMouseMove:a.func,onMouseOut:a.func,onMouseOver:a.func,onMouseUp:a.func,onNodeChange:a.func,onObjectResizeStart:a.func,onObjectResized:a.func,onObjectSelected:a.func,onPaste:a.func,onPostProcess:a.func,onPostRender:a.func,onPreProcess:a.func,onProgressState:a.func,onRedo:a.func,onRemove:a.func,onReset:a.func,onSaveContent:a.func,onSelectionChange:a.func,onSetAttrib:a.func,onSetContent:a.func,onShow:a.func,onSubmit:a.func,onUndo:a.func,onVisualAid:a.func},s=o({apiKey:a.string,id:a.string,inline:a.bool,init:a.object,initialValue:a.string,onEditorChange:a.func,outputFormat:a.oneOf(["html","text"]),value:a.string,tagName:a.string,cloudChannel:a.string,plugins:a.oneOfType([a.string,a.array]),toolbar:a.oneOfType([a.string,a.array]),disabled:a.bool,textareaName:a.string,tinymceScriptSrc:a.string,scriptLoading:a.shape({async:a.bool,defer:a.bool,delay:a.number})},r),c=function(e){return"function"===typeof e},l=function(e){return e in r},u=function(e){return e.substr(2)},d=function(e,t,n,i,a){return function(e,t,n,i,a,o,r){var s=Object.keys(a).filter(l),c=Object.keys(o).filter(l),d=s.filter((function(e){return void 0===o[e]})),p=c.filter((function(e){return void 0===a[e]}));d.forEach((function(e){var t=u(e),i=r[t];n(t,i),delete r[t]})),p.forEach((function(n){var a=i(e,n),o=u(n);r[o]=a,t(o,a)}))}(a,e.on.bind(e),e.off.bind(e),(function(t,n){return function(i){var a;return null===(a=t(n))||void 0===a?void 0:a(i,e)}}),t,n,i)},p=0,f=function(e){var t=Date.now();return e+"_"+Math.floor(1e9*Math.random())+ ++p+String(t)},m=function(e){return null!==e&&("textarea"===e.tagName.toLowerCase()||"input"===e.tagName.toLowerCase())},h=function(e){return"undefined"===typeof e||""===e?[]:Array.isArray(e)?e:e.split(" ")},g=function(e,t){return h(e).concat(h(t))},v=function(){return{listeners:[],scriptId:f("tiny-script"),scriptLoading:!1,scriptLoaded:!1}},y=function(){var e=v();return{load:function(t,n,i,a,o,r){var s=function(){return function(e,t,n,i,a,o){var r=t.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=e,r.src=n,r.async=i,r.defer=a;r.addEventListener("load",(function e(){r.removeEventListener("load",e),o()})),t.head&&t.head.appendChild(r)}(e.scriptId,t,n,i,a,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0}))};e.scriptLoaded?r():(e.listeners.push(r),e.scriptLoading||(e.scriptLoading=!0,o>0?setTimeout(s,o):s()))},reinitialize:function(){e=v()}}}(),b=n(448),w=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),E=function(){return(E=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},S=function(e){function t(t){var n,a,o,r=e.call(this,t)||this;return r.handleEditorChange=function(e){var t,n=r.editor;if(n&&n.initialized){var i=n.getContent({format:r.props.outputFormat});i!==r.currentContent&&(r.currentContent=i,c(r.props.onEditorChange)&&r.props.onEditorChange(null!==(t=r.currentContent)&&void 0!==t?t:"",n))}},r.initialise=function(){var e=r.elementRef.current;if(e){var t=Object(b.a)();if(!t)throw new Error("tinymce should have been loaded into global scope");var n=E(E({},r.props.init),{selector:void 0,target:e,readonly:r.props.disabled,inline:r.inline,plugins:g(r.props.init&&r.props.init.plugins,r.props.plugins),toolbar:r.props.toolbar||r.props.init&&r.props.init.toolbar,setup:function(t){r.editor=t,r.bindHandlers({}),r.inline&&!m(e)&&t.once("PostRender",(function(e){t.setContent(r.getInitialValue(),{no_events:!0})})),r.props.init&&c(r.props.init.setup)&&r.props.init.setup(t)}});r.inline||(e.style.visibility=""),m(e)&&(e.value=r.getInitialValue()),t.init(n)}},r.id=r.props.id||f("tiny-react"),r.elementRef=i.createRef(),r.inline=null!==(o=null!==(n=r.props.inline)&&void 0!==n?n:null===(a=r.props.init)||void 0===a?void 0:a.inline)&&void 0!==o&&o,r.boundHandlers={},r}return w(t,e),t.prototype.componentDidUpdate=function(e){var t,n=this;if(this.editor&&this.editor.initialized){if(this.bindHandlers(e),this.currentContent=null!==(t=this.currentContent)&&void 0!==t?t:this.editor.getContent({format:this.props.outputFormat}),"string"===typeof this.props.value&&this.props.value!==e.value&&this.props.value!==this.currentContent){var i=this.editor;i.undoManager.transact((function(){return i.setContent(n.props.value)}))}"boolean"===typeof this.props.disabled&&this.props.disabled!==e.disabled&&this.editor.setMode(this.props.disabled?"readonly":"design")}},t.prototype.componentDidMount=function(){var e,t,n,i,a,o;null!==Object(b.a)()?this.initialise():this.elementRef.current&&this.elementRef.current.ownerDocument&&y.load(this.elementRef.current.ownerDocument,this.getScriptSrc(),null!==(t=null===(e=this.props.scriptLoading)||void 0===e?void 0:e.async)&&void 0!==t&&t,null!==(i=null===(n=this.props.scriptLoading)||void 0===n?void 0:n.defer)&&void 0!==i&&i,null!==(o=null===(a=this.props.scriptLoading)||void 0===a?void 0:a.delay)&&void 0!==o?o:0,this.initialise)},t.prototype.componentWillUnmount=function(){var e=this,t=this.editor;t&&(t.off("change keyup setcontent",this.handleEditorChange),Object.keys(this.boundHandlers).forEach((function(n){t.off(n,e.boundHandlers[n])})),this.boundHandlers={},t.remove(),this.editor=void 0)},t.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},t.prototype.renderInline=function(){var e=this.props.tagName,t=void 0===e?"div":e;return i.createElement(t,{ref:this.elementRef,id:this.id})},t.prototype.renderIframe=function(){return i.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id})},t.prototype.getScriptSrc=function(){if("string"===typeof this.props.tinymceScriptSrc)return this.props.tinymceScriptSrc;var e=this.props.cloudChannel;return"https://cdn.tiny.cloud/1/"+(this.props.apiKey?this.props.apiKey:"no-api-key")+"/tinymce/"+e+"/tinymce.min.js"},t.prototype.getInitialValue=function(){return"string"===typeof this.props.value?this.props.value:"string"===typeof this.props.initialValue?this.props.initialValue:""},t.prototype.bindHandlers=function(e){var t=this;if(void 0!==this.editor){d(this.editor,e,this.props,this.boundHandlers,(function(e){return t.props[e]}));var n=function(e){return void 0!==e.onEditorChange||void 0!==e.value},i=n(e),a=n(this.props);!i&&a?this.editor.on("change keyup setcontent",this.handleEditorChange):i&&!a&&this.editor.off("change keyup setcontent",this.handleEditorChange)}},t.propTypes=s,t.defaultProps={cloudChannel:"5"},t}(i.Component);n.d(t,"a",(function(){return S}))},448:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=function(){return"undefined"!==typeof window?window:e},a=function(){var e=i();return e&&e.tinymce?e.tinymce:null}}).call(this,n(35))}}]);
//# sourceMappingURL=80.0c9b6731.chunk.js.map