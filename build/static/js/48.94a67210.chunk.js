(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[48],{964:function(e,a,t){"use strict";t.r(a);var s=t(21),i=t(6),n=t(11),r=t(13),l=t(12),o=t(31),d=t(14),c=t(0),m=t.n(c),p=t(24),h=t(3),g=t(2),u=t(1614),b=t(25),v=t.n(b),y=function(e){function a(e){var t;return Object(i.a)(this,a),(t=Object(r.a)(this,Object(l.a)(a).call(this,e))).changePassword=function(e){if(t.setState({isSaving:!0}),t.state.newPassword){var a={training_user_id:t.props.id,password:t.state.newPassword};h.l.put("".concat(h.a,"v2/training/user-password"),a).then((function(e){e.data.error?(p.b.error("Error change password"),t.setState({isSaving:!1})):(p.b.success("Success change user's password"),t.setState({isSaving:!1}),t.closeModalPassword())}))}else p.b.warning("Insert the new password")},t.validateEmail=function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)},t.save=function(e){if(t.setState({isSaving:!0}),e.preventDefault(),t.validateEmail(t.state.email)&&(t.props.match.params.id||t.state.expired||!t.state.license_number)&&t.state.name&&t.state.born_date&&t.state.gender&&t.state.address&&t.state.city&&t.state.phone&&t.state.email&&t.state.training_company_id)if(t.props.match.params.id){var a={image:t.state.image,training_company_id:t.state.training_company_id,name:t.state.name,born_place:t.state.born_place,born_date:t.state.born_date,gender:t.state.gender,identity:t.state.identity,tin:t.state.tin,license_number:t.state.license_number,address:t.state.address,city:t.state.city,phone:t.state.phone,email:t.state.email,created_by:g.a.get("user").data.user_id,tag:t.state.tag};h.l.put("".concat(h.a,"v2/training/user/").concat(t.props.match.params.id),a).then((function(e){if(e.data.error)p.b.error("Error edit ".concat(t.state.level," : ").concat(e.data.result));else if(t.state.image){t.setState({isSaving:!0});var a=new FormData;a.append("image",t.state.image),h.l.put("".concat(h.a,"v2/training/user/image/").concat(t.props.match.params.id),a).then((function(e){if(e.data.error)p.b.warning("".concat(t.state.level," edited but fail to upload image"));else if(t.state.imageIdentity){t.setState({isSaving:!0});var a=new FormData;a.append("image",t.state.imageIdentity),h.l.put("".concat(h.a,"v2/training/user/image-identity/").concat(t.props.match.params.id),a).then((function(e){e.data.error?p.b.warning("".concat(t.state.level," edited but fail to upload identity image")):(p.b.success("".concat(t.state.level," edited")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(t.props.match.params.id)))}))}else p.b.success("".concat(t.state.level," edited")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(t.props.match.params.id))}))}else if(t.state.imageIdentity){t.setState({isSaving:!0});var s=new FormData;s.append("image",t.state.imageIdentity),h.l.put("".concat(h.a,"v2/training/user/image-identity/").concat(t.props.match.params.id),s).then((function(e){e.data.error?p.b.warning("".concat(t.state.level," edited but fail to upload identity image")):(p.b.success("".concat(t.state.level," edited")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(t.props.match.params.id)))}))}else p.b.success("".concat(t.state.level," edited")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(t.props.match.params.id))}))}else{var s={training_company_id:t.state.training_company_id,image:t.state.image,name:t.state.name,born_place:t.state.born_place,born_date:t.state.born_date,gender:t.state.gender,identity:t.state.identity,tin:t.state.tin,license_number:t.state.license_number,expired:t.state.expired,address:t.state.address,city:t.state.city,phone:t.state.phone,email:t.state.email,level:t.props.match.params.level,created_by:g.a.get("user").data.user_id};h.l.post("".concat(h.a,"v2/training/user"),s).then((function(e){if(e.data.error)p.b.error("Error create ".concat(t.state.level," : ").concat(e.data.result)),t.setState({isSaving:!1});else if(t.state.image){t.setState({isSaving:!0});var a=new FormData;a.append("image",t.state.image),h.l.put("".concat(h.a,"v2/training/user/image/").concat(e.data.result.insertId),a).then((function(a){if(a.data.error)p.b.warning("".concat(t.state.level," created but fail to upload image")),t.goBack(),t.setState({isSaving:!1});else if(t.state.imageIdentity){t.setState({isSaving:!0});var s=new FormData;s.append("image",t.state.imageIdentity),h.l.put("".concat(h.a,"v2/training/user/image-identity/").concat(e.data.result.insertId),s).then((function(a){a.data.error?p.b.warning("".concat(t.state.level," created but fail to upload identity image")):(p.b.success("".concat(t.state.level," created")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(e.data.result.insertId)))}))}else p.b.success("".concat(t.state.level," created")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(e.data.result.insertId))}))}else if(t.state.imageIdentity){t.setState({isSaving:!0});var s=new FormData;s.append("image",t.state.imageIdentity),h.l.put("".concat(h.a,"v2/training/user/image-identity/").concat(e.data.result.insertId),s).then((function(a){a.data.error?p.b.warning("".concat(t.state.level," edited but fail to upload identity image")):(p.b.success("".concat(t.state.level," created")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(e.data.result.insertId)))}))}else p.b.success("".concat(t.state.level," created")),t.setState({isSaving:!1}),t.props.history.push("/training/user/detail/".concat(e.data.result.insertId))}))}else p.b.warning("Some field is required or not in their format, please check your data."),t.setState({isSaving:!1})},t.handleChange=function(e){var a=e.target,i=a.name,n=a.value;"image"===i?e.target.files.length&&(e.target.files[0].size<=5e6?t.setState({image:e.target.files[0],imagePreview:URL.createObjectURL(e.target.files[0])}):(e.target.value=null,p.b.warning("Image size cannot larger than 5MB"))):"imageIdentity"===i?e.target.files.length&&(e.target.files[0].size<=5e6?t.setState({imageIdentity:e.target.files[0],imageIdentityPreview:URL.createObjectURL(e.target.files[0])}):(e.target.value=null,p.b.warning("Identity Image size cannot larger than 5MB"))):t.setState(Object(s.a)({},i,n))},t.closeModalPassword=function(e){t.setState({modalPassword:!1,newPassword:""})},t.state={image:"",imagePreview:"assets/images/no-profile-picture.jpg",imageIdentity:"",imageIdentityPreview:"assets/images/no-image.png",training_company_id:"",name:"",born_place:"",born_date:"",gender:"",identity:"",tin:"",address:"",city:"",phone:"",email:"",level:"",license_number:"",expired:"",optionCompany:[],companyId:"",modalPassword:!1,newPassword:"",history:[],disabledForm:t.props.disabledForm&&t.props.id,isSaving:!1},t.goBack=t.goBack.bind(Object(o.a)(t)),t}return Object(d.a)(a,e),Object(n.a)(a,[{key:"goBack",value:function(){this.props.goBack?this.props.goBack():this.props.history.goBack()}},{key:"getUser",value:function(e){var a=this;h.l.get("".concat(h.a,"v2/training/user/read/").concat(e)).then((function(e){e.data.error?p.b.error("Error read user"):a.setState({training_company_id:e.data.result.training_company_id,name:e.data.result.name,born_place:e.data.result.born_place,born_date:e.data.result.born_date,gender:e.data.result.gender,identity:e.data.result.identity,tin:e.data.result.tin,license_number:e.data.result.license_number,address:e.data.result.address,city:e.data.result.city,phone:e.data.result.phone,email:e.data.result.email,imagePreview:e.data.result.image?e.data.result.image:a.state.imagePreview,imageIdentityPreview:e.data.result.identity_image?e.data.result.identity_image:a.state.imageIdentityPreview})})),this.getHistory(e)}},{key:"getHistory",value:function(e){var a=this;h.l.get("".concat(h.a,"v2/training/user-history/").concat(e)).then((function(e){e.data.error?p.b.error("Error read history"):a.setState({history:e.data.result})}))}},{key:"getUserData",value:function(){var e=this;h.l.get("".concat(h.j).concat(g.a.get("user").data.email)).then((function(a){200===a.status&&(e.setState({companyId:localStorage.getItem("companyID")?localStorage.getItem("companyID"):a.data.result.company_id}),e.getCompany(e.state.companyId))}))}},{key:"getCompany",value:function(e){var a=this;h.l.get("".concat(h.a,"v2/training/company/").concat(e)).then((function(e){e.data.error?p.b.error("Error read company"):a.setState({optionCompany:e.data.result})}))}},{key:"componentDidMount",value:function(){this.getUserData(),this.props.disabledForm&&this.props.id?this.getUser(this.props.id):this.props.match.params.id&&this.getUser(this.props.match.params.id),this.setState({level:this.props.match.params.level?this.props.match.params.level:"user",training_company_id:"0"!==this.props.match.params.company?this.props.match.params.company:""})}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"pcoded-main-container"},m.a.createElement("div",{className:"pcoded-wrapper"},m.a.createElement("div",{className:"pcoded-content"},m.a.createElement("div",{className:"pcoded-inner-content"},m.a.createElement("div",{className:"main-body"},m.a.createElement("div",{className:"page-wrapper"},m.a.createElement("div",{className:"floating-back"},m.a.createElement("img",{src:"newasset/back-button.svg",alt:"",width:90,onClick:this.goBack})),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-xl-12"},m.a.createElement("div",null,m.a.createElement("div",{className:"card p-20"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-10 m-b-20"},m.a.createElement("strong",{className:"f-w-bold f-18",style:{color:"#000"}},this.props.id?"Detail":this.props.match.params.id?"Edit":"Create New"," ","admin"===this.state.level?"Admin":"User")),m.a.createElement("div",{className:"col-sm-2 m-b-20"},this.props.disabledForm&&m.a.createElement("button",{onClick:this.props.goEdit,className:"btn btn-icademy-primary float-right",style:{padding:"7px 8px !important",marginRight:30}},m.a.createElement("i",{className:"fa fa-edit"}),"Edit"),this.props.disabledForm&&m.a.createElement("button",{onClick:function(){return e.setState({modalPassword:!0})},className:"btn btn-icademy-primary float-right",style:{padding:"7px 8px !important",marginRight:30}},m.a.createElement("i",{className:"fa fa-key"}),"Change Password"))),"client"===g.a.get("user").data.level?null:m.a.createElement("div",{className:"form-section"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold",style:{color:"#000",fontSize:"15px"}},"Company"))),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"training_company_id"},"Company Name",m.a.createElement("required",null,"*")),m.a.createElement("select",{name:"training_company_id",value:this.state.training_company_id,id:"training_company_id",onChange:this.handleChange,disabled:this.state.disabledForm},m.a.createElement("option",{value:""},"Select Company"),this.state.optionCompany.map((function(a){return m.a.createElement("option",{value:a.id,selected:e.state.training_company_id===a.id},a.name)})))))),m.a.createElement("div",{className:"form-section"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold",style:{color:"#000",fontSize:"15px"}},"Personal Information"))),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"image"},"Profile Picture"),m.a.createElement("center",null,m.a.createElement("label",{style:{cursor:"pointer",borderRadius:"4px",overflow:"hidden"}},m.a.createElement("a",{href:this.state.imagePreview,target:"_blank"},m.a.createElement("img",{src:this.state.imagePreview,style:{objectFit:"cover",width:"54.8px",height:"54.8px"}}))),m.a.createElement("label",{for:"image",style:{cursor:"pointer",overflow:"hidden",display:this.state.disabledForm?"none":"block"}},m.a.createElement("div",{className:"button-bordered-grey"},this.state.image?this.state.image.name:"Choose file"))),m.a.createElement("input",{type:"file",accept:"image/*",name:"image",id:"image",onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"name"},"Name",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"text",name:"name",id:"name",placeholder:!this.state.disabledForm&&"XXXX XXXX",value:this.state.name,onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"born_place"},"Born Place"),m.a.createElement("input",{type:"text",name:"born_place",id:"born_place",placeholder:!this.state.disabledForm&&"Jakarta",value:this.state.born_place,onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"born_date"},"Born Date",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"date",name:"born_date",id:"born_date",value:this.state.born_date,onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"gender"},"Gender",m.a.createElement("required",null,"*")),m.a.createElement("select",{name:"gender",id:"gender",onChange:this.handleChange,disabled:this.state.disabledForm},m.a.createElement("option",{value:""},"Select Gender"),m.a.createElement("option",{value:"Male",selected:"Male"===this.state.gender},"Male"),m.a.createElement("option",{value:"Female",selected:"Female"===this.state.gender},"Female"))))),m.a.createElement("div",{className:"form-section"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold",style:{color:"#000",fontSize:"15px"}},"Identification"))),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"imageIdentity"},"Identity Card Photo",m.a.createElement("required",null,"*")),m.a.createElement("center",null,m.a.createElement("label",{style:{cursor:"pointer",borderRadius:"4px",overflow:"hidden"}},m.a.createElement("a",{href:this.state.imageIdentityPreview,target:"_blank"},m.a.createElement("img",{src:this.state.imageIdentityPreview,style:{objectFit:"cover",width:"54.8px",height:"54.8px"}}))),m.a.createElement("label",{for:"imageIdentity",style:{cursor:"pointer",overflow:"hidden",display:this.state.disabledForm?"none":"block"}},m.a.createElement("div",{className:"button-bordered-grey"},this.state.imageIdentity?this.state.imageIdentity.name:"Choose file"))),m.a.createElement("input",{type:"file",accept:"image/*",name:"imageIdentity",id:"imageIdentity",onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"identity"},"Identity Card Number",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"text",name:"identity",id:"identity",placeholder:!this.state.disabledForm&&"1234567890",maxlength:"16",value:this.state.identity,onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"tin"},"Tax Identification Number"),m.a.createElement("input",{type:"text",name:"tin",id:"tin",placeholder:!this.state.disabledForm&&"1234567890",value:this.state.tin,onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"license_number"},"License Number"),m.a.createElement("input",{type:"text",size:"30",name:"license_number",id:"license_number",placeholder:this.state.disabledForm||this.props.match.params.id?"":"1234567890",value:this.state.license_number,onChange:this.handleChange,disabled:this.state.disabledForm})),this.state.license_number?!this.state.license_number.length||this.props.match.params.id||this.state.disabledForm?null:m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"expired"},"License Expired",m.a.createElement("required",{style:{fontSize:"11px"}},"*Required if License Number filled")),m.a.createElement("input",{type:"date",name:"expired",id:"expired",value:this.state.expired,onChange:this.handleChange,disabled:this.state.disabledForm})):null)),m.a.createElement("div",{className:"form-section"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold",style:{color:"#000",fontSize:"15px"}},"Address"))),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"address"},"Address",m.a.createElement("required",null,"*")),m.a.createElement("textarea",{name:"address",rows:"3",cols:"60",id:"address",placeholder:!this.state.disabledForm&&"Jl.Pahlawan Seribu, BSD City, Tangerang, 15322",value:this.state.address,onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"city"},"City",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"text",name:"city",id:"city",placeholder:!this.state.disabledForm&&"Jakarta",value:this.state.city,onChange:this.handleChange,disabled:this.state.disabledForm})))),m.a.createElement("div",{className:"form-section ".concat(!this.props.disabledForm&&this.state.history.length?"no-border":"")},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold",style:{color:"#000",fontSize:"15px"}},"Contact"))),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"phone"},"Phone Number",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"number",name:"phone",id:"phone",placeholder:!this.state.disabledForm&&"081234567890",value:this.state.phone,onChange:this.handleChange,disabled:this.state.disabledForm})),m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"email"},"Email",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"text",size:"50",name:"email",id:"email",placeholder:!this.state.disabledForm&&"email@host.com",value:this.state.email,onChange:this.handleChange,disabled:this.state.disabledForm})))),this.state.history.length&&this.props.disabledForm?m.a.createElement("div",{className:"form-section no-border"},m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-12 m-b-20"},m.a.createElement("strong",{className:"f-w-bold",style:{color:"#000",fontSize:"15px"}},"Company History"))),m.a.createElement("div",{className:"row"},m.a.createElement("table",{className:"table-log"},m.a.createElement("tr",null,m.a.createElement("th",null,"Time"),m.a.createElement("th",null,"Source Company"),m.a.createElement("th",null,"Destination Company"),m.a.createElement("th",null,"By")),this.state.history.map((function(e){return m.a.createElement("tr",null,m.a.createElement("td",null,v()(e.created_at).local().format("DD-MM-YYYY HH:mm")),m.a.createElement("td",null,e.source),m.a.createElement("td",null,e.destination),m.a.createElement("td",null,e.creator))}))))):null,m.a.createElement("div",{className:"row",style:{justifyContent:"flex-end"}},!this.props.disabledForm&&m.a.createElement("button",{onClick:this.save,disabled:this.state.isSaving,className:"btn btn-icademy-primary float-right",style:{padding:"7px 8px !important",marginRight:30}},m.a.createElement("i",{className:"fa fa-save"}),this.state.isSaving?"Saving...":"Save"))))))))))),m.a.createElement(u.a,{show:this.state.modalPassword,onHide:this.closeModalPassword},m.a.createElement(u.a.Header,{closeButton:!0},m.a.createElement(u.a.Title,{className:"text-c-purple3 f-w-bold",style:{color:"#00478C"}},"Change Password")),m.a.createElement(u.a.Body,null,m.a.createElement("div",{className:"form-field-top-label"},m.a.createElement("label",{for:"name"},"New Password",m.a.createElement("required",null,"*")),m.a.createElement("input",{type:"password",name:"newPassword",id:"newPassword",value:this.state.newPassword,onChange:this.handleChange}))),m.a.createElement(u.a.Footer,null,m.a.createElement("button",{className:"btn btm-icademy-primary btn-icademy-grey",onClick:this.closeModalPassword},"Cancel"),m.a.createElement("button",{className:"btn btn-icademy-primary",onClick:this.changePassword.bind(this),disabled:this.state.isSaving},m.a.createElement("i",{className:"fa fa-save"})," ",this.state.isSaving?"Saving...":"Save"))))}}]),a}(c.Component);a.default=y}}]);
//# sourceMappingURL=48.94a67210.chunk.js.map