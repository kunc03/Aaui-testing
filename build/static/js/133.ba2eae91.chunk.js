(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[133],{1494:function(e,t,a){"use strict";a.r(t);var l=a(0),s=a.n(l),r=a(2),n=a(3),c=a(18),i=(a(229),a(118),a(692)),m=a.n(i);a(731);class o extends l.Component{constructor(){super(...arguments),this.state={listSemester:[],semesterId:"",semesterInfo:{},jadwalKu:{},listKelas:[],kelasId:"",kelasInfo:{},listMurid:[],muridId:[],muridInfo:{},isLoading:!1,nilaiMurid:[],tahunAjaran:"",listTahunAjaran:[]},this.exportPDF=()=>{const e=new m.a("portrait","pt","A4");e.setFontSize(15);let t={startY:100,head:[["NO","SUBJECT","NILAI","TASK","QUIZ","EXAM","PRESENSI"]],body:this.state.nilaiMurid.map((e,t)=>[t+1,e.nama_pelajaran,(e.totalAkhirScoreTugas+e.totalAkhirScoreKuis+e.totalAkhirScoreUjian).toFixed(2),e.totalAkhirScoreTugas,e.totalAkhirScoreKuis,e.totalAkhirScoreUjian,0])};e.text("Report ",40,40),e.setFontSize(9),e.text("NIK",40,60),e.text(": ".concat(this.state.muridId[0]),120,60),e.text("NAME",40,75),e.text(": ".concat(this.state.muridInfo.nama),120,75),e.text("CLASS",40,90),e.text(": ".concat(this.state.kelasInfo.kelas_nama),120,90),e.text("SEMESTER",220,60),e.text(": ".concat(this.state.semesterInfo.semester_name),300,60),e.text("YEAR",220,75),e.text(": ".concat(this.state.kelasInfo.tahun_ajaran),300,75),e.setFontSize(15),e.autoTable(t),e.save("report.pdf")},this.selectTahunAjaran=e=>{const{value:t}=e.target;this.setState({tahunAjaran:t}),this.fetchJadwal(t)},this.selectSemester=e=>{e.preventDefault();let t=e.target.value,a=[...this.state.jadwalKu.jadwal],l=[...new Map(a.map(e=>[e.kelas_id,e])).values()].filter(e=>e.semester_id===parseInt(t));this.setState({semesterId:t,listKelas:l}),n.l.get("".concat(n.a,"v1/semester/").concat(t)).then(e=>{this.setState({semesterId:t,semesterInfo:e.data.result,listKelas:l})})},this.selectKelas=e=>{e.preventDefault();let t=e.target.value;n.l.get("".concat(n.a,"v2/kelas/one/").concat(t)).then(e=>{this.setState({kelasId:t,kelasInfo:e.data.result})}),this.fetchMurid(t)},this.selectMurid=e=>{console.log("state:",e),this.setState({isLoading:!0,nilaiMurid:[]}),n.l.get("".concat(n.a,"v2/murid/no-induk/").concat(e[0])).then(t=>{this.setState({muridId:e,muridInfo:t.data.result}),this.fetchNilaiMurid(this.state.semesterId,this.state.kelasId,t.data.result.user_id,this.state.tahunAjaran)})},this.resetFilter=e=>{e.preventDefault(),this.setState({semesterId:"",semesterInfo:{},listKelas:[],kelasId:"",kelasInfo:{},listPelajaran:[],pelajaranId:"",pelajaranInfo:{},muridId:[],isLoading:!1,nilaiMurid:[]})}}fetchJadwal(e){n.l.get("".concat(n.a,"v2/jadwal-mengajar/murid/").concat(r.a.get("user").data.user_id,"?tahunAjaran=").concat(e)).then(t=>{t.data.error&&console.log("Error: fetch pelajaran"),this.setState({jadwalKu:t.data.result});let a=t.data.result;n.l.get("".concat(n.a,"v2/murid/no-induk/").concat(a.no_induk)).then(e=>{this.setState({muridId:a.id,muridInfo:e.data.result})}),n.l.get("".concat(n.a,"v1/semester/").concat(a.semester_id)).then(e=>{this.setState({semesterId:a.semester_id,semesterInfo:e.data.result})}),n.l.get("".concat(n.a,"v2/kelas/one/").concat(a.kelas_id)).then(e=>{this.setState({kelasId:a.kelas_id,kelasInfo:e.data.result})}),this.fetchNilaiMurid(a.semester_id,a.kelas_id,r.a.get("user").data.user_id,e)})}fetchSemester(){n.l.get("".concat(n.a,"v1/semester/company/").concat(r.a.get("user").data.company_id)).then(e=>{e.data.error&&c.b.warning("Error fetch data semester"),this.setState({listSemester:e.data.result})})}fetchKelas(e){n.l.get("".concat(n.a,"v2/kelas/semester/").concat(r.a.get("user").data.company_id,"/").concat(e)).then(e=>{e.data.error&&c.b.warning("Error fetch data semester"),this.setState({listKelas:e.data.result})})}fetchMurid(e){n.l.get("".concat(n.a,"v2/murid/kelas/").concat(e)).then(e=>{e.data.error&&c.b.warning("Error fetch murid");let t=[];e.data.result.map(e=>{t.push({value:e.no_induk,label:"".concat(e.no_induk," - ").concat(e.nama)})}),this.setState({listMurid:t})})}fetchNilaiMurid(e,t,a,l){console.log("Query: ".concat(e," ").concat(t," ").concat(a)),n.l.get("".concat(n.a,"v2/guru/nilai-murid/").concat(e,"/").concat(t,"/").concat(a,"?tahunAjaran=").concat(l)).then(e=>{this.setState({nilaiMurid:e.data.result,isLoading:!1})})}componentDidMount(){let e=new Date,t=e.getMonth()<6?e.getFullYear()-1+"/"+e.getFullYear():e.getFullYear()+"/"+(e.getFullYear()+1),a=[];for(var l=0;l<6;l++)a.push("".concat(e.getFullYear()-l,"/").concat(e.getFullYear()-l+1));this.setState({tahunAjaran:t,listTahunAjaran:a}),this.fetchJadwal(t),this.fetchSemester()}render(){r.a.get("user").data.level;return s.a.createElement("div",{className:"pcoded-main-container"},s.a.createElement("div",{className:"pcoded-wrapper"},s.a.createElement("div",{className:"pcoded-content"},s.a.createElement("div",{className:"pcoded-inner-content"},s.a.createElement("div",{className:"main-body"},s.a.createElement("div",{className:"page-wrapper"},s.a.createElement("div",{className:"row mt-3"},s.a.createElement("div",{className:"col-xl-12"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-body"},s.a.createElement("form",null,s.a.createElement("div",{className:"form-group row"},s.a.createElement("div",{className:"col-sm-2"},s.a.createElement("label",null,"Tahun Ajaran"),s.a.createElement("select",{onChange:this.selectTahunAjaran,value:this.state.tahunAjaran,className:"form-control",required:!0},s.a.createElement("option",{value:"",selected:!0,disabled:!0},"Select"),this.state.listTahunAjaran.map(e=>s.a.createElement("option",{value:e},e)))),s.a.createElement("div",{className:"col-sm-3"},s.a.createElement("button",{className:"btn btn-v2 btn-success mt-4 mr-2",onClick:()=>this.exportPDF()},s.a.createElement("i",{className:"fa fa-download"})," Report"),s.a.createElement("button",{className:"btn btn-v2 btn-info mt-4",type:"reset",onClick:this.resetFilter},"Reset"))))))),s.a.createElement("div",{className:"col-xl-12"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-body"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-sm-2"},s.a.createElement("img",{style:{marginTop:"36px",marginLeft:"64px"},src:"/assets/images/user/avatar-1.png",className:"rounded-circle img-profile mb-4"})),s.a.createElement("div",{className:"col-sm-10"},s.a.createElement("form",{className:"mt-4"},s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-sm-2 col-form-label text-right"},"NO INDUK"),s.a.createElement("div",{className:"col-sm-4"},s.a.createElement("input",{type:"text",value:this.state.jadwalKu.no_induk,disabled:!0,className:"form-control"})),s.a.createElement("label",{className:"col-sm-2 col-form-label text-right"},"SEMESTER"),s.a.createElement("div",{className:"col-sm-4"},s.a.createElement("input",{type:"text",value:this.state.semesterInfo.semester_name,className:"form-control"}))),s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-sm-2 col-form-label text-right"}," NAME "),s.a.createElement("div",{className:"col-sm-4"},s.a.createElement("input",{type:"text",value:this.state.muridInfo.nama,className:"form-control"})),s.a.createElement("label",{className:"col-sm-2 col-form-label text-right"},"SCHOOL YEAR"),s.a.createElement("div",{className:"col-sm-4"},s.a.createElement("input",{type:"text",value:this.state.kelasInfo.tahun_ajaran,className:"form-control"}))),s.a.createElement("div",{className:"form-group row"},s.a.createElement("label",{className:"col-sm-2 col-form-label text-right"},"KELAS"),s.a.createElement("div",{className:"col-sm-4"},s.a.createElement("input",{type:"text",value:this.state.kelasInfo.kelas_nama,className:"form-control"})))))),s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-sm-12"},s.a.createElement("table",{className:"table table-striped mt-4 table-bordered"},s.a.createElement("thead",null,s.a.createElement("tr",{className:"text-center"},s.a.createElement("td",{style:{verticalAlign:"middle"},rowSpan:"2"},"NO"),s.a.createElement("td",{style:{verticalAlign:"middle"},rowSpan:"2"}," SUBJECT "),s.a.createElement("td",{style:{verticalAlign:"middle"},rowSpan:"2"}," TOTAL"),s.a.createElement("td",{colSpan:"3"},"NILAI HASIL BELAJAR"),s.a.createElement("td",{style:{verticalAlign:"middle"},rowSpan:"2"},"PERSENSI")),s.a.createElement("tr",{className:"text-center"},s.a.createElement("td",null,"TASK"),s.a.createElement("td",null,"QUIZ"),s.a.createElement("td",null,"EXAM"))),s.a.createElement("tbody",null,this.state.isLoading&&s.a.createElement("tr",null,s.a.createElement("td",{className:"text-center",colSpan:"7"},s.a.createElement("span",null,"Loading..."))),this.state.nilaiMurid.map((e,t)=>s.a.createElement("tr",{className:"text-center"},s.a.createElement("td",null,t+1),s.a.createElement("td",null,e.nama_pelajaran),s.a.createElement("td",null,(e.totalAkhirScoreTugas+e.totalAkhirScoreKuis+e.totalAkhirScoreUjian).toFixed(2)),s.a.createElement("td",null,Number.parseFloat(e.totalAkhirScoreTugas).toFixed(2),s.a.createElement("br",null),e.kumpulTugas.length,"/",e.totalTugas.length),s.a.createElement("td",null,Number.parseFloat(e.totalAkhirScoreKuis).toFixed(2),s.a.createElement("br",null),e.kumpulKuis.length,"/",e.totalKuis.length),s.a.createElement("td",null,Number.parseFloat(e.totalAkhirScoreUjian).toFixed(2),s.a.createElement("br",null),e.kumpulUjian.length,"/",e.totalUjian.length),s.a.createElement("td",null,e.persensi?e.persensi+"%":"0%")))))))))))))))))}}t.default=o}}]);
//# sourceMappingURL=133.ba2eae91.chunk.js.map